/* tooltipsy by Brian Cray
 * Lincensed under GPL2 - http://www.gnu.org/licenses/gpl-2.0.html
 * Option quick reference:
 * - alignTo: "element" or "cursor" (Defaults to "element")
 * - offset: Tooltipsy distance from element or mouse cursor, dependent on alignTo setting. Set as array [x, y] (Defaults to [0, -1])
 * - content: HTML or text content of tooltip. Defaults to "" (empty string), which pulls content from target element's title attribute
 * - load: function(element, tooltip, callback) to load content when tooltip is shown
 * - show: function(event, tooltip) to show the tooltip. Defaults to a show(100) effect
 * - hide: function(event, tooltip) to hide the tooltip. Defaults to a fadeOut(100) effect
 * - delay: A delay in milliseconds before showing a tooltip. Set to 0 for no delay. Defaults to 200
 * - css: object containing CSS properties and values. Defaults to {} to use stylesheet for styles
 * - className: DOM class for styling tooltips with CSS. Defaults to "tooltipsy"
 * - showEvent: Set a custom event to bind the show function. Defaults to mouseenter
 * - hideEvent: Set a custom event to bind the show function. Defaults to mouseleave
 * Method quick reference:
 * - $('element').data('tooltipsy').show(): Force the tooltip to show
 * - $('element').data('tooltipsy').hide(): Force the tooltip to hide
 * - $('element').data('tooltipsy').destroy(): Remove tooltip from DOM
 * More information visit http://tooltipsy.com/
 */(function(a){a.tooltipsy=function(b,c){this.options=c,this.$el=a(b),this.title=this.$el.attr("title")||"",this.$el.attr("title",""),this.random=parseInt(Math.random()*1e4),this.ready=!1,this.shown=!1,this.loaded=!1,this.width=0,this.height=0,this.delaytimer=null,this.$el.data("tooltipsy",this),this.init()},a.tooltipsy.prototype.init=function(){var b=this;b.settings=a.extend({},b.defaults,b.options),b.settings.delay=parseInt(b.settings.delay),typeof b.settings.content=="function"&&b.readify(),b.settings.showEvent===b.settings.hideEvent&&b.settings.showEvent==="click"?b.$el.toggle(function(a){b.settings.showEvent==="click"&&b.$el[0].tagName=="A"&&a.preventDefault(),b.settings.delay>0?b.delaytimer=window.setTimeout(function(){b.show(a)},b.settings.delay):b.show(a)},function(a){b.settings.showEvent==="click"&&b.$el[0].tagName=="A"&&a.preventDefault(),window.clearTimeout(b.delaytimer),b.delaytimer=null,b.hide(a)}):b.$el.bind(b.settings.showEvent,function(a){b.settings.showEvent==="click"&&b.$el[0].tagName=="A"&&a.preventDefault(),b.settings.delay>0?b.delaytimer=window.setTimeout(function(){b.show(a)},b.settings.delay):b.show(a)}).bind(b.settings.hideEvent,function(a){b.settings.showEvent==="click"&&b.$el[0].tagName=="A"&&a.preventDefault(),window.clearTimeout(b.delaytimer),b.delaytimer=null,b.hide(a)})},a.tooltipsy.prototype.show=function(b){var c=this;c.ready===!1&&c.readify(),c.shown===!1&&(function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(c.settings.css)>0&&c.$tip.css(c.settings.css),c.width=c.$tipsy.outerWidth(),c.height=c.$tipsy.outerHeight());if(c.settings.alignTo==="cursor"&&b){var d=[b.pageX+c.settings.offset[0],b.pageY+c.settings.offset[1]];if(d[0]+c.width>a(window).width())var e={top:d[1]+"px",right:d[0]+"px",left:"auto"};else var e={top:d[1]+"px",left:d[0]+"px",right:"auto"}}else var d=[function(a){return c.settings.offset[0]<0?a.left-Math.abs(c.settings.offset[0])-c.width:c.settings.offset[0]===0?a.left-(c.width-c.$el.outerWidth())/2:a.left+c.$el.outerWidth()+c.settings.offset[0]}(c.offset(c.$el[0])),function(a){return c.settings.offset[1]<0?a.top-Math.abs(c.settings.offset[1])-c.height:c.settings.offset[1]===0?a.top-(c.height-c.$el.outerHeight())/2:a.top+c.$el.outerHeight()+c.settings.offset[1]}(c.offset(c.$el[0]))];c.$tipsy.css({top:d[1]+"px",left:d[0]+"px"}),c.shown=!0,c.settings.show(b,c.$tipsy.stop(!0,!0)),c.loaded===!1&&(c.loaded=!0,c.settings.load(c.$el,c.$tip,function(){c.shown&&c.show(b)}))},a.tooltipsy.prototype.hide=function(a){var b=this;if(b.ready===!1)return;if(a&&a.relatedTarget===b.$tip[0]){b.$tip.bind("mouseleave",function(a){if(a.relatedTarget===b.$el[0])return;b.settings.hide(a,b.$tipsy.stop(!0,!0))});return}b.shown=!1,b.settings.hide(a,b.$tipsy.stop(!0,!0))},a.tooltipsy.prototype.readify=function(){this.ready=!0,this.$tipsy=a('<div id="tooltipsy'+this.random+'" style="position:absolute;z-index:2147483647;display:none">').appendTo("body"),this.$tip=a('<div class="'+this.settings.className+'">').appendTo(this.$tipsy),this.$tip.data("rootel",this.$el);var b=this.$el,c=this.$tip;this.$tip.html(this.settings.content!=""?typeof this.settings.content=="string"?this.settings.content:this.settings.content(b,c):this.title)},a.tooltipsy.prototype.offset=function(a){var b=ot=0;if(a.offsetParent)do a.tagName!="BODY"&&(b+=a.offsetLeft-a.scrollLeft,ot+=a.offsetTop-a.scrollTop);while(a=a.offsetParent);return{left:b,top:ot}},a.tooltipsy.prototype.destroy=function(){this.$tipsy.remove(),a.removeData(this.$el,"tooltipsy")},a.tooltipsy.prototype.defaults={alignTo:"element",offset:[0,-1],content:"",load:function(a,b,c){c()},show:function(a,b){b.fadeIn(100)},hide:function(a,b){b.fadeOut(100)},css:{},className:"tooltipsy",delay:200,showEvent:"mouseenter",hideEvent:"mouseleave"},a.fn.tooltipsy=function(b){return this.each(function(){new a.tooltipsy(this,b)})}})(jQuery);